
<!DOCTYPE HTML>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type="text/css">
        body {
        background: rgba(53,42,70,1);
        background: -moz-linear-gradient(top, rgba(53,42,70,1) 0%, rgba(88,66,122,1) 26%,
        rgba(88,66,122,1) 100%);
        background: -webkit-gradient(left top, left bottom, color-stop(0%, rgba(53,42,70,1)),
        color-stop(26%, rgba(88,66,122,1)), color-stop(100%, rgba(88,66,122,1)));
        background: -webkit-linear-gradient(top, rgba(53,42,70,1) 0%, rgba(88,66,122,1) 26%,
        rgba(88,66,122,1) 100%);
        background: -o-linear-gradient(top, rgba(53,42,70,1) 0%, rgba(88,66,122,1) 26%,
        rgba(88,66,122,1) 100%);
        background: -ms-linear-gradient(top, rgba(53,42,70,1) 0%, rgba(88,66,122,1) 26%,
        rgba(88,66,122,1) 100%);
        background: linear-gradient(to bottom, rgba(53,42,70,1) 0%, rgba(88,66,122,1) 26%,
        rgba(88,66,122,1) 100%);
        filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#352a46',
        endColorstr='#58427a', GradientType=0 );
        overflow: hidden;
        }
        body,
        html {
        height: 100%;
        width: 100%;
        margin: 0;
        padding: 0;
        }
        .container{
        position:absolute;
        width:100%;
        top: 13% !important;
        }
        svg{
        width:100%;
        visibility:hidden;
        overflow:hidden;
        }
        .main_container {
        /*background-color: #58427a;
        bottom: -223px;
        height: 100%;
        position: absolute;
        width: 100%;
        z-index: -9;*/
        }
    </style>
    <script src="http://code.jquery.com/jquery-1.12.0.min.js"></script>
</head>
<body>
<div class="container">
    <svg class="mainSVG" version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 600">
        <defs>
            <filter id="goo">
                <feGaussianBlur in="SourceGraphic" stdDeviation="1" result="blur"/>
                <feColorMatrix in="blur" mode="matrix"
                               values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 12 -1.9" result="cm"/>
            </filter>
            <g id="bubble" stroke="#F3F1E2">
                <ellipse fill="none" stroke-width="1" opacity=0.0 stroke-miterlimit="10" cx="8"
                         cy="8" rx="7" ry="7"/>
                <path fill="none" stroke-linecap="round" stroke-linejoin="round"
                      stroke-miterlimit="10" d="M3.39,8
              c0.07-0.84,0.35-1.68,0.87-2.42c0.5-0.71,1.15-1.25,1.89-1.61"/>
            </g>
            <path id="heart" opacity=0.0 fill="none" stroke="#F3F1E2" stroke-linecap="round"
                  stroke-linejoin="round" stroke-miterlimit="10" d="
            M11.58,3.55c0,4.16-4.32,8.04-5.54,8.04S0.5,7.7,0.5,3.55c0-1.68,1.36-3.05,3.05-3.05c1.03,0,1.94,0.51,2.49,1.3
            c0.55-0.78,1.46-1.3,2.49-1.3C10.22,0.5,11.58,1.86,11.58,3.55z M3.99,2.25c-0.86,0-1.72,0.78-1.78,1.86"/>
            <g id="pop" class="pop" fill="none" stroke="#F3F1E2" stroke-linecap="round"
               stroke-linejoin="round" stroke-miterlimit="10" opacity="0">
                <circle cx="18.22" cy="17.89" r="0" stroke="#F3F1E2" fill="none"/>
                <line x1="18" y1="10.5" x2="18" y2="0.5"/>
                <line x1="18" y1="25.5" x2="18" y2="35.5"/>
                <line x1="25.5" y1="18" x2="35.5" y2="18"/>
                <line x1="10.5" y1="18" x2="0.5" y2="18"/>
            </g>
        </defs>
        <g id="follower" opacity=0.0></g>
        <path id="waveyPath" fill="none" stroke="none" stroke-width="3.5" stroke-linecap="round"
              stroke-miterlimit="10" d="M300,338
          c100,0,100,36,199.99,36c100,0,100-36,200-36c100,0,100,36,200,36c100,0,100-36,200-36c100,0,100,36,200.01,36s100-36,200.01-36"/>
        <g id="movingPath">
            <path id="filledMovingPath" fill="#58427A" d="M2300.5,338c-100,0-100,36-200.01,36
            c-100,0-100-36-200.01-36c-100,0-100,36-200,36c-100,0-100-36-200-36c-100,0-100,36-200,36c-100,0-100-36-199.99-36
            c-100,0-100,36-200.01,36s-100-36-200.01-36c-100,0-100,36-200,36c-100,0-100-36-200-36c-100,0-100,36-200,36
            c-100,0-100-36-199.99-36v423h2400V338z"/>
            <path class="movingPath" fill="none" stroke="#F3F1E2" stroke-width="2"
                  stroke-linecap="round" stroke-miterlimit="10" d="M-100,338
            c100,0,100,36,199.99,36c100,0,100-36,200-36c100,0,100,36,200,36c100,0,100-36,200-36c100,0,100,36,200.01,36s100-36,200.01-36
            c100,0,100,36,199.99,36c100,0,100-36,200-36c100,0,100,36,200,36c100,0,100-36,200-36c100,0,100,36,200.01,36
            c100,0,100-36,200.01-36"/>
        </g>
        <g id="jumpingLorry">
            <g id="movingLorry">
                <g id="lorryGroup" fill="none" stroke="#F3F1E2" stroke-width="2"
                   stroke-linecap="round" stroke-miterlimit="10">
                    <path id="XMLID_197_" fill-rule="evenodd" clip-rule="evenodd" fill="none"
                          stroke="#FFFFFF" stroke-width="0.5" stroke-miterlimit="10" d="
              M165.188,32.533c0.311,2.237-0.264,9.417-1.058,11.063c-0.423,0.876-2.744,2.278-6.431,2.839
              c-3.693,0.56-10.639,0.862-13.136,0.852c-0.279-0.001-0.566-0.001-0.854-0.006c2.068-6.992,0.398-11.523-1.399-14.546
              c3.695,3.039,4.021,8.861,2.5,13.735c6.918-0.411,11.821-0.525,13.826-0.943c2.001-0.415,4.59-1.901,4.979-2.657
              c0.039-0.073,0.082-0.229,0.128-0.447c-0.269,0.011-0.533,0.021-1.208-0.003c-1.181-0.041-0.608-6.535,0.725-7.218
              c0.489-0.251,0.939-0.149,1.332-0.064c0.112-1.377,0.173-2.408,0.128-2.49c-0.138-0.257-5.15-2.916-5.15-2.916
              c-0.38-0.136-16.149-3.952-13.984-6.811c-7.729-1.874-13.347-2.817-23.52-3.22c-1.545,0.05-2.859,0.884-7.416,1.37
              c-2.61,0.28-4.716,0.259-8.433,0.281c-3.717,0.023-9.454-0.543-14.166-0.784c-2.766-0.142-45.139-2.721-41.678-7.281
              c7.973-6.093,27.484-6.833,36.258-5.363c7.041,1.184,18.011,6.842,17.253,7.103c-0.748,0.26-2.412,1.331-2.218,2.388
              c0.28,1.559,2.379,1.487,3.584,1.445l0.076,1.541l-0.214-1.299c-6.184-0.131-3.17-4.283-1.63-4.168
              c-5.877-3.428-12.585-6.06-19.39-6.916c-4.477-0.563-12.362-0.268-17.138,0.417c0.244,1.047,1.831,8.104,2.126,9.415
              c12.73,1.281,33.616,2.939,37.514,3.033c1.643,0.042,3.406-0.009,5.036-0.096l-4.449-3.301c0,0,0.393,3.232,0.364,3.143
              c-0.029-0.091-0.663-3.746-0.663-3.746l5.421,3.866l3.488-0.265l0,0l0,0l0,0l0,0l0,0c0.014,0,0.073-0.006,0.229-0.029
              c-1.162-0.288-1.757-0.618-3.461-1.504c-1.703-0.885-18.966-10.474-19.322-10.727c-0.359-0.253-0.122-0.829,0.026-1.051
              c-4.14-1.223-13.46-1.83-19.861-1.381c-13.063,0.915-34.718,6.649-49.974,9.113c6.969-0.407,21.503-0.348,23.961-0.348
              c1.753,0,2.278,5.996,12.566,6.721c0.008,0.002-11.188,0.317-13.787-6.281l-24.083,0.161c-5.645,1.064-9.497,1.772-9.707,1.754
              c-0.813-0.076-4.063-1.059-4.408-0.996c-0.348,0.059-0.228,1.329-0.258,1.539c-0.029,0.212-1.086,0-1.48,0.061
              c-0.467,0.071-0.338,3.064,0.423,3.957c0,0-0.09,2.657-0.663,3.563c-0.575,0.905-1.194,1.586-1.465,1.888
              c-0.272,0.301,0.981,7.792,0.966,8.064c-0.001,0.02-0.006,0.035-0.012,0.053c1.778,0.677,4.186,1.555,3.672,4.013
              c-0.152,0.729-0.697,1.2-1.069,1.449c-0.499,0.333-0.849,0.453-0.756,0.391c0.091-0.058,1.533-1.466,1.594-2.115
              c0.201-2.145-2.05-2.901-3.698-3.572c-0.219,0.067-0.501,0.083-0.59,0.129c-0.15,0.076,0.098,2.71,0.286,3.231
              c0.189,0.52,0.892,0.672,0.892,0.672s0.998,3.138,2.598,4.44c1.601,1.302,5.414,1.968,6.987,2.266
              c-0.035-0.204-0.555-3.375-0.321-6.589c0.361-4.97,2.775-9.001,7.612-11.454c-9.071,6.222-6.791,14.919-6.639,18.193l0,0l0,0l0,0
              h-0.002l0,0v-0.001l0,0c-0.015,0-0.086-0.014-0.208-0.034c-0.695-0.112-2.984-0.501-5.106-1.084
              c-2.536-0.694-3.352-1.448-4.076-2.235c-0.724-0.784-1.329-3.262-1.329-3.262s-0.181-0.151-0.575-0.423
              C4.36,38.786,4.21,35.583,4.24,35.131c0.031-0.454,0.543-0.242,0.665-0.393C5.027,34.586,4,27.398,4,26.886
              c0-0.514,0.604-0.362,1.297-1.419c0.696-1.057,0.996-3.807,0.996-3.807s-0.36-0.573-0.573-1.175c-0.211-0.605,0-2.575,0.067-3.118
              s1.445-0.325,1.445-0.325c0.134-1.016-0.055-2.087,1.72-1.601c1.135,0.309,3.472,0.934,3.836,0.934S62.773,6.076,72.316,5.413
              c6.159-0.429,15.973-0.208,21.774,1.781c3.172,1.087,27.216,12.02,27.216,12.02s5.136,0,9.905,0.543
              c4.772,0.543,13.533,2.296,16.371,3.384c2.838,1.086,10.811,5.375,12.323,6.16C161.41,30.087,165.188,32.533,165.188,32.533
              L165.188,32.533z M120.759,19.5c-2.769-1.255-24.485-11.1-26.38-11.92c-0.252-0.109-0.499-0.204-0.746-0.288
              C93.5,7.5,93.217,7.874,93.515,8.106c0.299,0.231,12.886,7.046,16.478,9.124c3.593,2.077,5.324,2.68,7.378,2.992
              C118.389,20.012,120.037,19.657,120.759,19.5L120.759,19.5z M66.446,8.513c-7.626,0.976-15.534,3.972-15.393,5.094
              c0.09,0.725,2.113,2.114,9.542,3.262c1.584,0.244,4.355,0.563,7.78,0.911C68.104,16.48,66.635,9.437,66.446,8.513z"/>

                    <path id="XMLID_83_" fill-rule="evenodd" clip-rule="evenodd" fill="none"
                          stroke="#FFFFFF" stroke-width="0.5" stroke-miterlimit="10" d="
              M143.269,29.54c-7.948-8.926-21.808-5.532-32.375-5.187c-5.85,0.192-100.212-5.022-101.181-4.902
              c-0.966,0.122-1.509,7.491-1.509,7.491s1.179-6.796,1.63-6.946c0.453-0.152,89.49,5.889,94.02,6.432
              c4.529,0.544,17.698,1.451,17.698,1.451s-13.47-1.813-15.283-2.116c-1.81-0.301-1.81-0.423-1.81-0.423
              C122.276,24.856,134.122,21.453,143.269,29.54z"/>

                    <path id="XMLID_82_" fill-rule="evenodd" clip-rule="evenodd" fill="none"
                          stroke="#FFFFFF" stroke-width="0.5" stroke-miterlimit="10" d="
              M116.251,46.497c-0.302,0.423-72.303-0.302-72.303-0.302s1.208-6.643-0.967-11.597c-2.157-4.915-7.396-7.077-12.472-7.818
              c8.881,0.182,15.289,5.507,14.709,18.328l69.641,0.485c0.795,0.003-0.343-9.681,5.604-14.055
              C117.819,35.312,115.869,36.866,116.251,46.497z"/>

                    <path id="XMLID_81_" fill-rule="evenodd" clip-rule="evenodd" fill="none"
                          stroke="#FFFFFF" stroke-width="0.5" stroke-miterlimit="10" d="
              M49.445,43.176c2.217-9.142,14.668-7.569,23.437-6.767c-1.825-0.076-19.194-0.818-18.968,2.598
              c0.061,0.906,0.725,1.148,0.364,2.114C53.914,42.089,49.445,43.176,49.445,43.176z"/>

                    <path id="XMLID_80_" fill-rule="evenodd" clip-rule="evenodd" fill="none"
                          stroke="#FFFFFF" stroke-width="0.5" stroke-miterlimit="10" d="
              M145.638,32.454c6.343-0.158,8.995,8.378,9.002,11.476c0,0.405-1.771-0.304-1.813-0.604
              C152.392,40.374,151.434,33.56,145.638,32.454z"/>
                    <g id="XMLID_154_">

                        <path id="XMLID_155_" fill-rule="evenodd" clip-rule="evenodd" fill="none"
                              stroke="#FFFFFF" stroke-width="0.5" stroke-miterlimit="10" d="
                M130.523,29.225c6.726,0,12.177,5.453,12.177,12.18c0,6.723-5.451,12.177-12.177,12.177c-6.727,0-12.181-5.454-12.181-12.177
                C118.343,34.677,123.797,29.225,130.523,29.225L130.523,29.225z M117.668,41.405c0,7.098,5.755,12.854,12.855,12.854
                c7.1,0,12.854-5.756,12.854-12.854c0-7.103-5.755-12.857-12.854-12.857C123.423,28.548,117.668,34.302,117.668,41.405z"/>
                    </g>
                    <g id="XMLID_94_">

                        <path id="XMLID_95_" fill-rule="evenodd" clip-rule="evenodd" fill="none"
                              stroke="#FFFFFF" stroke-width="0.5" stroke-miterlimit="10" d="
                M29.948,29.225c6.726,0,12.178,5.453,12.178,12.18c0,6.723-5.453,12.177-12.178,12.177c-6.728,0-12.177-5.454-12.177-12.177
                C17.771,34.677,23.22,29.225,29.948,29.225L29.948,29.225z M17.093,41.405c0,7.098,5.755,12.854,12.855,12.854
                s12.856-5.756,12.856-12.854c0-7.103-5.757-12.857-12.856-12.857S17.093,34.302,17.093,41.405z"/>
                    </g>
                </g>
            </g>
        </g>
    </svg>
    <!-- <div class="main_container"></div> -->
</div>
<script src="http://cdnjs.cloudflare.com/ajax/libs/gsap/1.18.0/TweenMax.min.js"></script>
<script src="http://s3-us-west-2.amazonaws.com/s.cdpn.io/16327/MorphSVGPlugin.min.js"></script>
<script src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/35984/ScrubGSAPTimeline.js"></script>
<!-- <script src="http://s3-us-west-2.amazonaws.com/s.cdpn.io/16327/DrawSVGPlugin.js?r=12"></script> -->
<script>
      var xmlns = "http://www.w3.org/2000/svg",
      xlinkns = "http://www.w3.org/1999/xlink"
      select = function(s) {
      return document.querySelector(s);
      },
      selectAll = function(s) {
      return document.querySelectorAll(s);
      },
      container = select('.container'),
      mainSVG = select('.mainSVG'),
      waveyPath = select('#waveyPath'),
      pop = select('#pop'),
      follower = select('#follower'),
      movingPath = select('#movingPath'),
      jumpingLorry = select('#jumpingLorry'),
      movingLorry = select('#movingLorry'),
      lorryGroup = select('#lorryGroup'),
      particleContainer = select('#particleContainer'),
      //particleTypeArray = ['#flake1', '#flake2', '#flake3', '#star','#heart'],
      particleTypeArray = ['#bubble', '#heart'],
      particleColorArray = ['#F3F1E2', '#B51541'],
      particlePool = [],
      popPool = [],
      numParticles = 270,
      particleCount = 0
      
      //center the container cos it's pretty an' that
      TweenMax.set(container, {
      position: 'absolute',
      top: '50%',
      left: '50%',
      xPercent: -50,
      yPercent: -50
      })
      TweenMax.set('svg', {
      visibility: 'visible'
      })
      
      TweenMax.set(lorryGroup, {
      transformOrigin: '50% 100%'
      })
      TweenMax.set(jumpingLorry, {
      transformOrigin: '50% 50%',
      rotation: 0
      })
      TweenMax.set(follower, {
      x: 0,
      y: 0
      })
      TweenMax.set(pop, {
      alpha:0
      
      })
      var waveyPathBezier = MorphSVGPlugin.pathDataToBezier(waveyPath.getAttribute('d'), {
      offsetX: -(lorryGroup.getBBox().width / 2),
      offsetY: -(lorryGroup.getBBox().height) - waveyPath.getAttribute('stroke-width')
      })
      
      var tl = new TimelineMax({
      repeat: -1,
      onUpdate: playParticle
      });
      tl.to(lorryGroup, 6, {
      bezier: {
      type: "cubic",
      values: waveyPathBezier,
      autoRotate: true
      },
      ease: Linear.easeNone
      })
      .to([movingPath, movingLorry], 6, {
      x: -1200,
      ease: Linear.easeNone
      }, '-=6')
      
      var jumpTl = new TimelineMax();
      jumpTl.to(lorryGroup, 0.16, {
      //y:-6,
      scaleY: 0.97,
      scaleX: 1.03,
      repeat: -1,
      ease: Linear.easeNone,
      yoyo: true
      })
      
      function createParticlePool() {
      
      var i = numParticles,
      p, popClone;
      while (--i > -1) {
      
      p = document.createElementNS(xmlns, 'use');
      popClone = pop.cloneNode(true);
      //pop.setAttributeNS(xlinkns, "xlink:href", '#pop');
      p.setAttributeNS(xlinkns, "xlink:href", particleTypeArray[i % particleTypeArray.length]);
      follower.appendChild(p);
      follower.appendChild(popClone);
      
      p.setAttributeNS(null, 'stroke', particleColorArray[i % particleColorArray.length]);
      //popClone.setAttributeNS(null, 'opacity', 1);
      //p.setAttribute('class', "particle");
      particlePool.push(p);
      popPool.push(popClone);
      TweenMax.set([p, popClone], {
      transformOrigin: '50% 50%',
      alpha:1
      //x:300,
      //y:follower._gsTransform.y
      })
      
      
      TweenMax.set([p], {
      scale: 0
      })
      
      }
      
      }
      
      //ScrubGSAPTimeline(tl);
      
      function playParticle() {
      //console.log(particleCount%250 == 1)
      
      if (particleCount % 13) {
      particleCount++;
      checkParticleCount();
      return;
      }
      
      var p = particlePool[particleCount];
      TweenMax.set(p, {
      x: 260,
      y: lorryGroup._gsTransform.y + 12,
      //scale:0,
      alpha: 1
      })
      
      var s = randomBetween(5, 10) / 10;
      TweenMax.to(p, 0.46, {
      scaleX: s,
      ease: Elastic.easeOut.config(1, 0.83)
      })
      TweenMax.to(p, 0.6, {
      scaleY: s,
      ease: Elastic.easeOut.config(1, 0.4)
      })
      TweenMax.to(p, randomBetween(1, 2), {
      //paused:true,
      physics2D: {
      velocity: randomBetween(30, 165),
      angle: randomBetween(-180, -160),
      gravity: randomBetween(-130, -17)
      },
      onComplete: function(p) {
      TweenMax.set(p, {
      scale: 0
      })
      
      createPop(p);
      },
      onCompleteParams: [p]
      });
      
      particleCount++;
      
      checkParticleCount();
      }
      
      function createPop(p) {
      
      var popTl = new TimelineMax(),
      popClone = popPool[particleCount],
      popLines = popClone.getElementsByTagName('line'),
      popCircle = popClone.getElementsByTagName('circle');
      TweenMax.set(popClone, {
      x: p._gsTransform.x - 10,
      y: p._gsTransform.y - 10,
      rotation: 45
      })
      
      TweenMax.set(popCircle, {
      alpha: 1,
      attr: {
      r: 0
      }
      })
      popTl.set(popLines, {
      drawSVG: '0% 0%'
      
      })
      .to(popLines, 0.3, {
      drawSVG: '0% 20%',
      ease: Linear.easeNone
      })
      .to(popLines, 0.6, {
      drawSVG: '80% 100%',
      ease: Linear.easeNone
      })
      .to(popLines, 0.2, {
      drawSVG: '105% 105%',
      ease: Linear.easeNone
      })
      .to(popClone, 1, {
      x: '-=20',
      y: '-=20',
      scale: 0.5,
      ease: Linear.easeNone
      }, '-=' + popTl.duration())
      .to(popCircle, 1, {
      attr: {
      r: 6
      },
      alpha: 0,
      ease: Expo.easeOut
      }, '-=' + popTl.duration());
      
      popTl.timeScale(1.6)
      }
      
      function checkParticleCount() {
      particleCount = (particleCount >= numParticles) ? 0 : particleCount;
      }
      
      tl.timeScale(1);
      createParticlePool();
      //ScrubGSAPTimeline(tl);
      function randomBetween(min, max) {
      return Math.floor(Math.random() * (max - min + 1) + min);
      }

</script>
</body>
</html>